# Violet
Project on SQL(Inventory Structure)
CREATE DATABASE DEMO;
USE DEMO;
CREATE TABLE EMP
(EID VARCHAR(5),
NAME VARCHAR(20),
ADDR VARCHAR(50),
CITY VARCHAR(20),
DOB DATE,
PHONE VARCHAR(15),
EMAIL VARCHAR(50));
INSERT INTO EMP (EID,NAME,ADDR,CITY,DOB,PHONE,EMAIL) VALUES('E0001','PULKIT CHOUDHARY','SECTOR 9 RKP','DELHI','16-MAY-1996',7982692268,'PULKIT.CHOUDHARY311@GMAIL.COM'); 
SELECT *FROM EMP;
INSERT INTO EMP VALUES('E0002','AKSHAY KUMAR','SECTOR 9 RKP','DELHI','04-AUG-1994',8527419576,'AKKUMAR@GMAIL.COM');
INSERT INTO EMP VALUES('E0003','LOKESH KUSHWAHA','SECTOR 8 RKP','DELHI','02-JAN-1993',9999954321,'LOKI@GMAIL.COM');
INSERT INTO EMP VALUES('E0004','SAURAV SAIJWAN','SECTOR 12 RKP','DELHI','03-OCT-1993',9999912345,'SSAIJWAN@GMAIL.COM');
INSERT INTO EMP VALUES('E0005','VARUN CHAWLA','MEHRAULI','DELHI','18-JUL-1992',9999978945,'CHAWLA@YAHOO.COM');
INSERT INTO EMP VALUES('E0006','RHOHIT SHARMA','SECTOR 12 RKP','DELHI','10-DEC-1991',9999952147,'RS@GMAIL.COM');
INSERT INTO EMP VALUES('E0007','ANKUSH KALSHYA','DWARKA MOR','DELHI','07-JUL-1990',9999974102,'KALSHYAN@GMAIL.COM');
INSERT INTO EMP VALUES('E0008','ASIM ERIC TIGGA','DWARKA SECTOR 13','DELHI','04-APR-1996',9992974102,'TIGGA@GMAIL.COM');
INSERT INTO EMP VALUES('E0009','ADARSH ASTHANA','GREEN FIELDS','FARIDABAD','14-JAN-1992',8999974102,'AA@GMAIL.COM');
INSERT INTO EMP VALUES('E0010','NAVEEN KUMAR','NARELA','DELHI','07-JUL-1990',9999972514,'ARYAN@GMAIL.COM');
UPDATE EMP SET NAME = 'ROHIT SHARMA' WHERE EID = 'E0006';

DELETE FROM EMP;
SELECT * FROM EMP;

SELECT *FROM EMP
WHERE NAME LIKE '%SHARMA%';

CREATE TABLE EMP_SAL
(EID VARCHAR(5),
DEPT CHAR(20),
DESI VARCHAR(20),
DOJ DATE,
SALARY INT);
INSERT INTO EMP_SAL VALUES('E0001','HR','MANAGER','25-JUL-2012',65000);
INSERT INTO EMP_SAL VALUES('E0002','SALES','TEAM LEAD','02-SEP-2015',55000);
INSERT INTO EMP_SAL VALUES('E0003','FINANCE','ASSISTANT MANAGER','05-JAN-2011',80000);
INSERT INTO EMP_SAL VALUES('E0004','SALES','SALES MANAGER','14-NOV-2013',85000);
INSERT INTO EMP_SAL VALUES('E0005','R&D','SR.MANAGER','11-JUL-2016',125000);
INSERT INTO EMP_SAL VALUES('E0006','FINANCE','DIRECTOR','07-JAN-2019',165000);
INSERT INTO EMP_SAL VALUES('E0007','HR','EXECUTIVE','01-APR-2015',45000);
SELECT *FROM EMP_SAL
WHERE DESI LIKE '%MANAGER';
SELECT*FROM EMP_SAL;
UPDATE EMP_SAL
SET SALARY = (SALARY *110)/100 WHERE DESI LIKE '%MANAGER';
SELECT * FROM EMP_SAL;

ALTER TABLE EMP
ALTER COLUMN EID VARCHAR(5)NOT NULL;
ALTER TABLE EMP
ADD CONSTRAINT A1 PRIMARY KEY(EID);
ALTER TABLE EMP
ALTER COLUMN NAME VARCHAR(20) NOT NULL;
ALTER TABLE EMP
ADD CONSTRAINT A2 CHECK(ADDR NOT LIKE '%UTTAM NAGAR%');
ALTER TABLE EMP
ADD CONSTRAINT A3 CHECK(CITY IN('DELHI','GURGOAN','FARIDABAD','NOIDA'));
ALTER TABLE EMP
ALTER COLUMN CITY VARCHAR (50) NOT NULL;
ALTER TABLE EMP
ADD CONSTRAINT A4 UNIQUE(PHONE); 
ALTER TABLE EMP
ADD CONSTRAINT A5 CHECK(DOB < '01-JAN-2000');
ALTER TABLE EMP
ADD CONSTRAINT A6 CHECK(EMAIL LIKE '%GMAIL%' OR EMAIL LIKE '%YAHOO%');
INSERT INTO EMP VALUES('E0011','PULU','UTTAM NAGAR','DELHI','25-JAN-1999',9999912347,'PF@GMAIL.COM');
DELETE FROM EMP WHERE EID = 'E0011';
ALTER TABLE EMP DROP CONSTRAINT A2;

SELECT * FROM EMP;

USE DEMO;
UPDATE EMP_SAL 
SET SALARY = (SALARY *100)/110 WHERE DESI LIKE '%MANAGER';
SELECT * FROM EMP_SAL;
UPDATE EMP_SAL
SET DESI = 'ASSOCIATE' WHERE EID = 'E0002';
UPDATE EMP_SAL
SET DESI = 'VP' WHERE EID = 'E0003';
UPDATE EMP_SAL
SET DESI = 'DIRECTOR' WHERE EID = 'E0004';
UPDATE EMP_SAL
SET DESI = 'MANAGER' WHERE EID = 'E0005';
UPDATE EMP_SAL
SET DESI = 'VP' WHERE EID = 'E0006';
UPDATE EMP_SAL
SET DESI = 'ASSOCIATE' WHERE EID = 'E0007';
UPDATE EMP_SAL
SET SALARY = (SALARY *100)/110 WHERE DESI LIKE '%MANAGER%';
UPDATE EMP_SAL
SET DEPT = 'HR' WHERE EID = 'E0001';
UPDATE EMP_SAL
SET DEPT = 'OPS' WHERE EID = 'E0002';
UPDATE EMP_SAL
SET DEPT = 'ADMIN' WHERE EID = 'E0003';
UPDATE EMP_SAL
SET DEPT = 'IT' WHERE EID = 'E0004';
UPDATE EMP_SAL
SET DEPT = 'OPS' WHERE EID = 'E0005';
UPDATE EMP_SAL
SET DEPT = 'MIS' WHERE EID = 'E0006';
UPDATE EMP_SAL
SET DEPT = 'OPS' WHERE EID = 'E0007';
SELECT * FROM EMP_SAL;

ALTER TABLE EMP_SAL
ADD CONSTRAINT A7 FOREIGN KEY(EID) REFERENCES EMP(EID);
 ALTER TABLE EMP_SAL
ADD CONSTRAINT A8 CHECK(DESI IN('ASSOCIATE','MANAGER','VP','DIRECTOR'));
ALTER TABLE EMP_SAL
ADD CONSTRAINT A9 CHECK(DEPT IN('HR','OPS','ADMIN','IT','MIS','TEMP'));
ALTER TABLE EMP_SAL
ADD CONSTRAINT A10 CHECK(SALARY>20000);
ALTER TABLE EMP_SAL
ADD CONSTRAINT A11 DEFAULT 'TEMP' FOR DEPT;

SELECT CITY,COUNT(EID) AS 'NUMBER OF EMPLOYEES' FROM EMP GROUP BY CITY ORDER BY [NUMBER OF EMPLOYEES] DESC;

SELECT * FROM EMP WHERE EMAIL NOT LIKE '%YAHOO%';


SELECT DESI ,COUNT(EID) AS 'NUMBER OF EMPLOYEES',SUM(SALARY) AS 'TOTAL COST' FROM EMP_SAL GROUP BY DESI ORDER BY [TOTAL COST] DESC;

SELECT  EMP.EID, EMP.NAME, EMP.ADDR, EMP.CITY, EMP_SAL.DOJ, EMP_SAL.DESI, EMP_SAL.DEPT, EMP_SAL.SALARY
FROM EMP
INNER JOIN EMP_SAL 
ON EMP.EID = EMP_SAL.EID
WHERE CITY = 'DELHI';

UPDATE EMP SET CITY = 'FARIDABAD'
WHERE EID = 'E0004';
SELECT * FROM EMP;

SELECT  EMP.EID, EMP.NAME, EMP.ADDR, EMP.CITY, EMP_SAL.DOJ, EMP_SAL.DESI, EMP_SAL.DEPT, EMP_SAL.SALARY
FROM EMP
LEFT JOIN EMP_SAL 
ON EMP.EID = EMP_SAL.EID
WHERE SALARY IS NULL;
SELECT*FROM EMP_SAL;
SELECT*FROM EMP;
UPDATE EMP_SAL SET DOJ = '11-JUL-2019' WHERE EID = 'E0005';


CREATE VIEW V1 
AS 
   SELECT EMP.EID, NAME ,DOJ,DEPT,DESI,SALARY AS 'BASIC',SALARY*.15 AS 'HRA',SALARY*.9 AS 'PF',(SALARY+SALARY*.15+SALARY*.9) AS 'NET',SALARY=((SALARY+SALARY*.15+SALARY*.9)-SALARY*.9) FROM EMP
INNER JOIN EMP_SAL
ON EMP.EID=EMP_SAL.EID;
SELECT * FROM V1;

SELECT EMP.EID,NAME,DOJ,DESI,DEPT FROM EMP
INNER JOIN EMP_SAL
ON EMP.EID=EMP_SAL.EID
WHERE DESI = 'MANAGER' AND DOJ>='01-JAN-2019' AND DOJ<='31-DEC-2020';


SELECT DEPT, COUNT(EID) AS 'TEAM SIZE',AVG(SALARY) AS 'AVERAGE SALARY' FROM EMP_SAL GROUP BY DEPT;

SELECT DESI,COUNT(EID) AS 'TOTAL'FROM EMP_SAL WHERE DESI = 'MANAGER' GROUP BY DESI;

SELECT DESI,MAX(SALARY) AS MAXIMUM,MIN(SALARY) AS MINIMUM FROM EMP_SAL WHERE DESI = 'ASSOCIATE' GROUP BY DESI;

SELECT DEPT,COUNT(EID) AS 'TEAM SIZE',AVG(SALARY) AS 'AVERAGE SALARY' FROM EMP_SAL GROUP BY DEPT 

SELECT * FROM EMP_SAL
SELECT * FROM EMP;															
																														 
CREATE VIEW V2
AS
  SELECT EMP.EID,NAME,CITY,DEPT,SALARY FROM EMP
  INNER JOIN EMP_SAL
  ON EMP.EID=EMP_SAL.EID;

  SELECT * FROM V2;
USE DEMO;
SELECT DEPT,COUNT(EID)AS 'TEAM SIZE',AVG(SALARY)AS 'AVERAGE SALARY' FROM V2 WHERE CITY= 'DELHI' GROUP BY DEPT;

SELECT EID,NAME,UPPER(CONCAT(LEFT(NAME,1),LEFT(RIGHT(NAME,LEN(NAME)-CHARINDEX(' ',NAME)),1),RIGHT(EID,3),'RCG.COM')) AS 'COREMAIL' FROM EMP;

SELECT * FROM EMP;

UPDATE EMP SET DOB = '14-JAN-1980'
WHERE EID = 'E0009';

SELECT NAME,CITY,PHONE,EMAIL,DATEDIFF(YEAR,DOB,GETDATE()) AS AGE FROM EMP
 WHERE DATEDIFF(YEAR,DOB,GETDATE()) >=40;

SELECT EMP.EID,NAME,DOJ,DATEDIFF(YEAR,DOJ,GETDATE())AS TENURE FROM EMP
INNER JOIN EMP_SAL
ON EMP.EID=EMP_SAL.EID
WHERE DATEDIFF(YEAR,DOJ,GETDATE()) >=5;

SELECT EMP.EID,NAME,DEPT,DESI,CITY,PHONE,EMAIL FROM EMP
INNER JOIN EMP_SAL
ON EMP.EID=EMP_SAL.EID
WHERE MONTH(DOB) = MONTH(GETDATE())
AND DESI = 'MANAGER';

SELECT *FROM EMP_SAL
WHERE SALARY = (SELECT MAX(SALARY)FROM EMP_SAL);

SELECT EID,NAME,LEN(NAME) AS 'LONGEST NAME' FROM EMP
WHERE LEN(NAME)=(SELECT(MAX(LEN(NAME)))FROM EMP);

SELECT * FROM EMP;

CREATE FUNCTION MYFUN(@X AS INT,@Y AS INT)
RETURNS INT
AS
BEGIN
	DECLARE @Z AS INT;
	SET @Z=@X*@Y;
	RETURN @Z;
END;

SELECT DBO.MYFUN(10,20);

CREATE FUNCTION COMAIL(@A AS VARCHAR(30),@B AS VARCHAR(5))
RETURNS TABLE
AS
	RETURN(SELECT(CONCAT(LEFT(NAME,1),LEFT(RIGHT(NAME,LEN(NAME)-CHARINDEX(' ',NAME)),1),RIGHT(EID,3),'@RCG.COM'))AS 'OFFICALMAIL' FROM EMP
	WHERE NAME = @A AND EID=@B);  

SELECT * FROM DBO.COMAIL('PULKIT CHOUDHARY' ,'E0001');	

DROP FUNCTION COMAIL;

CREATE FUNCTION EMPINFO(@A AS VARCHAR(30))
RETURNS TABLE
AS
	RETURN(SELECT EMP.EID,NAME,DESI,DEPT,SALARY FROM EMP
	INNER JOIN EMP_SAL
	ON EMP.EID=EMP_SAL.EID
	WHERE DEPT = @A);

SELECT * FROM DBO.EMPINFO('OPS');


                                                           A4(6)


CREATE FUNCTION HBD(@M INT)
RETURNS TABLE
AS
	RETURN(SELECT EMP.NAME,DOB,DESI,DEPT,CITY FROM EMP
	INNER JOIN EMP_SAL
	ON EMP.EID=EMP_SAL.EID
	WHERE MONTH(DOB) = @M);

SELECT * FROM DBO.HBD(7);

DROP FUNCTION HBD;
					
					              
CREATE FUNCTION TENURE(@Y AS INT)
RETURNS TABLE
AS
	RETURN(SELECT EMP.NAME,DEPT,DOJ FROM EMP
	INNER JOIN EMP_SAL
	ON EMP.EID=EMP_SAL.EID
	WHERE (DATEDIFF(YEAR,DOJ,GETDATE()))=@Y);

SELECT * FROM DBO.TENURE(3);

SELECT * FROM EMP_SAL;

USE MASTER;
CREATE DATABASE INVENTORY;

USE INVENTORY;

CREATE TABLE SUPPLIER
(SID VARCHAR(5),SNAME VARCHAR (30),SADDRESS VARCHAR(50),SCITY VARCHAR(20),SPHONE VARCHAR(15),EMAIL VARCHAR(50));

CREATE TABLE PRODUCT
(PID VARCHAR(5),PDESC VARCHAR(30),PRICE INT,CATEGORY VARCHAR(20),SID VARCHAR(5));

CREATE TABLE CUSTOMER
(CID VARCHAR(5),CNAME VARCHAR(30),ADDRESS VARCHAR(50),CITY VARCHAR(20),PHONE VARCHAR(15),EMAIL VARCHAR(50),DOB DATE);

CREATE TABLE ORDERS
(OID VARCHAR(5),ORDER_DATE DATE,CID VARCHAR(5),PID VARCHAR(5),ORDER_QUANTITY INT);

CREATE TABLE STOCK
(PID VARCHAR(5),STOCKQUANTITY INT,REORDER_LEVEL INT,MINIMUM_ORDER_QUANTITY INT);

ALTER TABLE SUPPLIER
ALTER COLUMN SNAME VARCHAR(30) NOT NULL;

ALTER TABLE SUPPLIER
ALTER COLUMN SADDRESS VARCHAR(50) NOT NULL;

ALTER TABLE SUPPLIER
ADD CONSTRAINT A1 CHECK (SCITY='DELHI');

ALTER TABLE SUPPLIER
ADD CONSTRAINT A2 UNIQUE(SPHONE);

ALTER TABLE SUPPLIER
ALTER COLUMN SID VARCHAR(5) NOT NULL;

ALTER TABLE SUPPLIER
ADD CONSTRAINT A3 PRIMARY KEY(SID);





ALTER TABLE PRODUCT
ALTER COLUMN PID VARCHAR(5) NOT NULL;

ALTER TABLE PRODUCT
ADD CONSTRAINT PK2 PRIMARY KEY(PID);

ALTER TABLE PRODUCT
ALTER COLUMN PDESC VARCHAR(50) NOT NULL;

ALTER TABLE PRODUCT
ADD CONSTRAINT A4 CHECK(PRICE>0);

ALTER TABLE PRODUCT
ADD CONSTRAINT A5 CHECK(CATEGORY IN('IT','HA','HC'));

ALTER TABLE CUSTOMER
ALTER COLUMN CID VARCHAR(5) NOT NULL;

ALTER TABLE CUSTOMER
ADD CONSTRAINT PK3 PRIMARY KEY(CID);

ALTER TABLE CUSTOMER
ALTER COLUMN CNAME VARCHAR(20) NOT NULL;


ALTER TABLE CUSTOMER
ALTER COLUMN ADDRESS VARCHAR(50) NOT NULL;


ALTER TABLE CUSTOMER
ALTER COLUMN CITY VARCHAR(20) NOT NULL;


ALTER TABLE CUSTOMER
ALTER COLUMN PHONE VARCHAR(15) NOT NULL;


ALTER TABLE CUSTOMER
ALTER COLUMN EMAIL VARCHAR(30) NOT NULL;


ALTER TABLE CUSTOMER
ALTER COLUMN CNAME VARCHAR(20) NOT NULL;


ALTER TABLE CUSTOMER
ADD CONSTRAINT A6 CHECK(DOB<'1-JAN-2000');

ALTER TABLE ORDERS
ALTER COLUMN OID VARCHAR(5) NOT NULL;

ALTER TABLE ORDERS
ADD CONSTRAINT PK4 PRIMARY KEY(OID);

ALTER TABLE ORDERS
ADD CONSTRAINT A7 CHECK(ORDER_QUANTITY>=1);

ALTER TABLE STOCK
ADD CONSTRAINT A8 CHECK(STOCKQUANTITY>=0);


ALTER TABLE STOCK
ADD CONSTRAINT A9 CHECK(REORDER_LEVEL>0);


ALTER TABLE STOCK
ADD CONSTRAINT A10 CHECK(MINIMUM_ORDER_QUANTITY>=5);

ALTER TABLE PRODUCT
ADD CONSTRAINT FK1 FOREIGN KEY(SID) REFERENCES SUPPLIER(SID);


ALTER TABLE ORDERS
ADD CONSTRAINT FK2 FOREIGN KEY(CID) REFERENCES CUSTOMER(CID);


ALTER TABLE ORDERS
ADD CONSTRAINT FK3 FOREIGN KEY(PID) REFERENCES PRODUCT(PID);


ALTER TABLE STOCK
ADD CONSTRAINT FK4 FOREIGN KEY(PID) REFERENCES PRODUCT(PID);

INSERT INTO SUPPLIER VALUES('S0001','SUNIL NAIR','143 MUNIRKA','DELHI',9876543219,'NAIR@GMAIL.COM');

INSERT INTO SUPPLIER VALUES('S0002','ROSHAN MATHUR','87B ROHINI','DELHI',9988776655,'MATHUR@GMAIL.COM');

INSERT INTO SUPPLIER VALUES('S0003','ROHAN PREET','56/2 RAJOURI GARDEN','DELHI',9998887776,'PREET@YAHOO.COM');

INSERT INTO SUPPLIER VALUES('S0004','RAJKUMAR RAO','1/12 LODHI ROAD','DELHI',9988777666,'RAO@GMAIL.COM');

INSERT INTO SUPPLIER VALUES('S0005','THOMAS SHELBY','1/1 VASANT VIHAR','DELHI',987456123,'PB@YAHOO.COM');

SELECT * FROM SUPPLIER;

USE INVENTORY;

INSERT INTO PRODUCT VALUES('P0001','HP_CPU',85000,'IT','S0001');

INSERT INTO PRODUCT VALUES('P0002','HP_PRINTER',15000,'IT','S0001');

INSERT INTO PRODUCT VALUES('P0003','HP_UPS',2599,'IT','S0001');

INSERT INTO PRODUCT VALUES('P0004','HA_MONITOR',8799,'HA','S0002');

INSERT INTO PRODUCT VALUES('P0005','DELL_KEYBOARD',2500,'HA','S0002');

INSERT INTO PRODUCT VALUES('P0006','DELL_MOUSE',879,'HA','S0002');

INSERT INTO PRODUCT VALUES('P0007','HCL_MOUSE',879,'HA','S0002');

UPDATE PRODUCT SET PDESC='DELL_UPS' WHERE PID='P0004';

UPDATE PRODUCT SET PDESC='DELL_UPS' WHERE PID='P0006';
UPDATE PRODUCT SET PRICE=2499 WHERE PID='P0006';
SELECT * FROM PRODUCT;
UPDATE PRODUCT SET PDESC='DELL_MONITOR' WHERE PID='P0004';

INSERT INTO PRODUCT VALUES('P0008','HP_MONITOR',9000,'IT','S0003');


INSERT INTO PRODUCT VALUES('P0009','HP_KEYBOARD',2799,'IT','S0003');

INSERT INTO PRODUCT VALUES('P0010','HP_MOUSE',1300,'IT','S0003');


INSERT INTO PRODUCT VALUES('P0011','DELL_MOUSE',999,'HA','S0004');

INSERT INTO PRODUCT VALUES('P0012','DELL_CPU',75000,'HA','S0004');

INSERT INTO PRODUCT VALUES('P0013','DELL_PRINTER',12000,'HA','S0004');

INSERT INTO PRODUCT VALUES('P0014','HCL_PRINTER',12000,'HC','S0005');

INSERT INTO PRODUCT VALUES('P0015','HCL_KEYBOARD',2199,'HC','S0005');

INSERT INTO PRODUCT VALUES('P0016','HCL_CPU',70000,'HC','S0005');

INSERT INTO PRODUCT VALUES('P0017','HCL_MONITOR',8000,'HC','S0005');

INSERT INTO PRODUCT VALUES('P0018','HCL_UPS',2399,'HC','S0005');

SELECT * FROM PRODUCT;

INSERT INTO CUSTOMER VALUES('C0001','BALI RAM','234/12 RKP','DELHI', '9852145789','RAM@GMAIL.COM','1-FEB-1993');

INSERT INTO CUSTOMER VALUES('C0002','ERIC TIGGA','SECTOR-13 DWARKA','DELHI', '9851245789','TIGGA@GMAIL.COM','3-APR-1996');

INSERT INTO CUSTOMER VALUES('C0003','NITIN RAWAT','8/5 SAKET','DELHI', '7852145789','RAWAT@GMAIL.COM','29-NOV-1991');

INSERT INTO CUSTOMER VALUES('C0004','SRISHTI ARORA','245B-MEHRAULI','DELHI', '9852145124','ARORA@GMAIL.COM','31-JAN-1996');

INSERT INTO CUSTOMER VALUES('C0005','PARVEEN CHAUHAN','12/2 MAHIPALPUR','DELHI', '9852115979','CHAUHAN@GMAIL.COM','14-AUG-1998');

INSERT INTO CUSTOMER VALUES('C0006','SHIVAM CHOUDHARY','SECTOR-14 ROHINI','DELHI', '7958145789','CHOUDHARY@GMAIL.COM','15-DEC-1995');

INSERT INTO CUSTOMER VALUES('C0007','NAVEEN KUMAR ARYAN','324/9 NARELA','DELHI', '9852111889','ARYAN@GMAIL.COM','7-JUL-1996');

SELECT * FROM CUSTOMER;

INSERT INTO ORDERS VALUES('O0001','21-JAN-2021','C0002','P0012',5);

INSERT INTO ORDERS VALUES('O0002','21-JUL-2021','C0005','P0001',10);

INSERT INTO ORDERS VALUES('O0003','04-AUG-2021','C0006','P0007',8);

INSERT INTO ORDERS VALUES('O0004','15-AUG-2021','C0001','P0010',1);

INSERT INTO ORDERS VALUES('O0005','2-SEP-2021','C0005','P0003',4);

SELECT * FROM ORDERS;

SELECT * FROM PRODUCT;

INSERT INTO STOCK VALUES('P0001',5,2,8);

INSERT INTO STOCK VALUES('P0012',10,5,15);

INSERT INTO STOCK VALUES('P0007',18,5,10);

INSERT INTO STOCK VALUES('P0010',11,5,10);

INSERT INTO STOCK VALUES('P0003',18,5,10);

INSERT INTO STOCK VALUES('P0006',24,10,15);

INSERT INTO STOCK VALUES('P0016',32,10,40);

INSERT INTO STOCK VALUES('P0014',12,5,10);

INSERT INTO STOCK VALUES('P0017',16,10,10);

INSERT INTO STOCK VALUES('P0009',17,8,20);

SELECT * FROM STOCK;


USE DEMO;

SELECT * FROM EMP;

UPDATE EMP SET CITY = 'GURGOAN' WHERE EID = 'E0003';

UPDATE EMP SET CITY = 'GURGOAN' WHERE EID = 'E0006';

SELECT EID ,NAME ,CITY FROM EMP
WHERE EID IN(SELECT EID FROM EMP WHERE CITY = 'GURGOAN');

SELECT * FROM EMP_SAL;

SELECT EMP.EID,NAME,DOJ,DEPT,SALARY FROM EMP
INNER JOIN EMP_SAL
ON EMP.EID=EMP_SAL.EID
WHERE DESI='MANAGER';

UPDATE EMP_SAL SET SALARY=SALARY+(SALARY*0.1)
WHERE EID IN(SELECT EID FROM EMP WHERE CITY='DELHI');

SELECT EMP.EID,NAME,CITY,DOJ,DEPT,DESI,SALARY FROM EMP
INNER JOIN EMP_SAL
ON EMP.EID=EMP_SAL.EID
WHERE DEPT='OPS' OR DEPT='HR'; 

USE DEMO;

CREATE TABLE TRAINING
(EID VARCHAR(5),
NAME VARCHAR(30),
DEPT VARCHAR(20));

INSERT INTO TRAINING (EID,NAME,DEPT)
(SELECT EMP.EID,NAME,DEPT FROM EMP
 INNER JOIN EMP_SAL
 ON EMP.EID=EMP_SAL.EID	
 WHERE DEPT='OPS'); 

SELECT * FROM TRAINING;

DELETE FROM TRAINING
WHERE EID IN(SELECT EID FROM EMP_SAL WHERE DESI='MANAGER');

SELECT * FROM EMP_SAL WHERE DEPT='OPS' AND EXISTS (SELECT * FROM EMP_SAL WHERE SALARY>100000);

USE INVENTORY;

SELECT * FROM SUPPLIER;

CREATE PROCEDURE ADDSUPP @ID VARCHAR(5),@SN VARCHAR(30),@SA VARCHAR(50),@SC VARCHAR(20),@SP VARCHAR(15),@SE VARCHAR(40)
AS
BEGIN
	INSERT INTO SUPPLIER VALUES(@ID,@SN,@SA,@SC,@SP,@SE)
	SELECT * FROM SUPPLIER
	WHERE SID=@ID
END;	

SELECT * FROM PRODUCT;

CREATE PROCEDURE ADDPRO @ID VARCHAR(5),@PD VARCHAR(20),@PP INT,@PC VARCHAR(20),@PS VARCHAR(5)
AS
BEGIN
	INSERT INTO PRODUCT VALUES(@ID,@PD,@PP,@PC,@PS)
	SELECT * FROM PRODUCT
	WHERE PID=@ID
END;

SELECT * FROM CUSTOMER;

CREATE PROCEDURE ADDCUS @ID VARCHAR(5),@CN VARCHAR(20),@CA VARCHAR(50),@CC VARCHAR(20),@CP VARCHAR(15),@CE VARCHAR(40),@CDOB DATE
AS
BEGIN
	INSERT INTO CUSTOMER VALUES(@ID,@CN,@CA,@CC,@CP,@CE,@CDOB)
	SELECT * FROM CUSTOMER
	WHERE CID=@ID
END;

SELECT * FROM ORDERS;

DELETE FROM ORDERS WHERE OID='O0006';

CREATE PROCEDURE ADDORD @ID VARCHAR(5),@OCID VARCHAR(5),@OPID VARCHAR(5),@OQTY INT
AS
BEGIN
	INSERT INTO ORDERS(OID,CID,PID,ORDER_QUANTITY) VALUES(@ID,@OCID,@OPID,@OQTY)
	SELECT * FROM ORDERS
	WHERE OID=@ID
END;

DROP PROCEDURE ADDORD;

ADDORD 'O0006','C0002','P0011',6;
 
 USE INVENTORY;

 
SELECT * FROM ORDERS;

 ALTER TABLE ORDERS
 ADD CONSTRAINT ODATE DEFAULT GETDATE() FOR ORDER_DATE;

 USE DEMO;

 SELECT * FROM EMP;
 SELECT * FROM EMP_SAL;

 INSERT INTO EMP_SAL VALUES('E0008','HR','DIRECTOR','21-JAN-2014',90000);
 
 INSERT INTO EMP_SAL VALUES('E0009','ADMIN','DIRECTOR','21-JUL-2015',80000);
 
 INSERT INTO EMP_SAL VALUES('E0010','IT','DIRECTOR','27-SEP-2016',115000);

 INSERT INTO EMP VALUES('E0011','AMAN GUPTA','SOUTH CITY-2','GURGOAN','31-DEC-1991','9874147851','GUPTA@GMAIL.COM');
 
 INSERT INTO EMP VALUES('E0012','RAMESH SHARMA','SECTOR-15','NOIDA','30-AUG-1991','9774147851','SHARMA@GMAIL.COM');
 
 INSERT INTO EMP VALUES('E0013','SRISHTI ARORA','SURAJKUND','FARIDABAD','12-SEP-1994','8874147851','ARORA@GMAIL.COM');

 INSERT INTO EMP VALUES('E0014','RAGHU RAMAN','PALAM VIHAR','GURGOAN','14-FEB-1989','9874147881','RAMAN@GMAIL.COM');
 
 INSERT INTO EMP VALUES('E0015','DIMPY SHARMA','SECTOR-56','NOIDA','15-OCT-1992','8774147851','SHARMA2@GMAIL.COM');
 
 INSERT INTO EMP VALUES('E0016','RAHUL ARORA','SECTOR-88','FARIDABAD','15-AUG-1996','9874147841','ARORA1@GMAIL.COM');

 INSERT INTO EMP VALUES('E0017','PRAVEEN CHAUHAN','SOUTH CITY-2','GURGOAN','16-MAR-1993','9988552212','CHAUHAN@GMAIL.COM');
 
 INSERT INTO EMP VALUES('E0018','AMIT PAUL','SECTOR-17','NOIDA','30-JUL-1991','9774140000','PAUL@GMAIL.COM');
 
 INSERT INTO EMP VALUES('E0019','RAHUL ROY','SECTOR-82','FARIDABAD','27-FEB-1994','9971147851','ROY@GMAIL.COM');

 INSERT INTO EMP VALUES('E0020','ZAYN MALIK','SIKANDARPUR','GURGOAN','11-SEP-1989','9224177881','MALIK@GMAIL.COM');
 
 INSERT INTO EMP VALUES('E0021','RAHUL KOCHAR','SECTOR-42','NOIDA','7-NOV-1990','8788847851','KOCHAR@GMAIL.COM');
 
 INSERT INTO EMP VALUES('E0022','HARDIK ARYAN','MG ROAD','GURGOAN','26-JAN-1995','9855547851','ARYAN@GMAIL.COM');
 
 INSERT INTO EMP VALUES('E0023','PIYUSH JAISWAL','SECTOR-39','NOIDA','07-JUN-1992','8874147122','JAISWAL@GMAIL.COM');
 
 INSERT INTO EMP VALUES('E0024','ANKIT KUMAR','SETOR-88','FARIDABAD','30-SEP-1994','8874147222','KUMAR@GMAIL.COM');

 INSERT INTO EMP VALUES('E0025','VIKRAM THAPA','VASANT GOAN','DELHI','11-NOV-1990','9874147111','THAPA@GMAIL.COM');
 
SELECT * FROM EMP_SAL;

INSERT INTO EMP_SAL VALUES('E0011','HR','VP','21-JAN-2016',125000);

INSERT INTO EMP_SAL VALUES('E0012','MIS','ASSOCIATE','21-OCT-2016',55000);

INSERT INTO EMP_SAL VALUES('E0013','OPS','VP','11-DEC-2017',135000);

INSERT INTO EMP_SAL VALUES('E0014','ADMIN','DIRECTOR','15-NOV-2013',225000);

INSERT INTO EMP_SAL VALUES('E0015','IT','DIRECTOR','01-MAR-2014',105000);


INSERT INTO EMP_SAL VALUES('E0016','HR','ASSOCIATE','21-OCT-2016',55000);

INSERT INTO EMP_SAL VALUES('E0017','MIS','ASSOCIATE','21-OCT-2016',55000);

INSERT INTO EMP_SAL VALUES('E0018','OPS','MANAGER','11-JUL-2017',65000);

INSERT INTO EMP_SAL VALUES('E0019','ADMIN','MANAGER','15-JUN-2013',55000);

INSERT INTO EMP_SAL VALUES('E0020','IT','VP','01-DEC-2014',175000);

INSERT INTO EMP_SAL VALUES('E0021','HR','MANAGER','21-FEB-2016',70000);

INSERT INTO EMP_SAL VALUES('E0022','MIS','ASSOCIATE','01-NOV-2016',55000);

INSERT INTO EMP_SAL VALUES('E0023','OPS','DIRECTOR','20-DEC-2014',135000);

USE INVENTORY;

SELECT * FROM PRODUCT;

ADDPRO 'P0019','HP_CPU',85000,'IT','S0001';

ADDPRO 'P0020','HP_PRINTER',15000,'IT','S0001';

ADDPRO 'P0021','HP_UPS',2599,'IT','S0001';

ADDPRO 'P0022','DELL_MONITOR',8799,'HA','S0002';

ADDPRO 'P0023','DELL_UPS',2499,'HA','S0002';

ADDPRO 'P0024','DELL_KEYBOARD',2500,'HA','S0002';

ADDPRO 'P0025','HCL_MOUSE',879,'HA','S0002';

ADDPRO 'P0026','HP_MONITOR',9000,'IT','S0003';

ADDPRO 'P0027','HP_KEYBOARD',2799,'IT','S0003';

ADDPRO 'P0028','HP_MOUSE',1300,'IT','S0003';

ADDPRO 'P0029','DELL_MOUSE',999,'HA','S0004';

ADDPRO 'P0030','DELL_CPU',75000,'HA','S0004';

ADDPRO 'P0031','DELL_PRINTER',12000,'HA','S0004';

ADDPRO 'P0032','HCL_PRINTER',12700,'HC','S0005';

ADDPRO 'P0033','HCL_KEYBOARD',2199,'HC','S0005';

ADDPRO 'P0034','HCL_CPU',70000,'HC','S0005';

ADDPRO 'P0035','HCL_MONITOR',8000,'HC','S0005';

ADDPRO 'P0036','HCL_UPS',2399,'HC','S0005';

SELECT * FROM PRODUCT;
SELECT * FROM SUPPLIER;

CREATE FUNCTION IDGEN (@C CHAR(1),@I INT)
RETURNS CHAR(5)
AS
BEGIN
	DECLARE @ID AS CHAR(5);

	SELECT @ID=CASE
					WHEN @I<10 THEN CONCAT(@C,'000',@I)
					WHEN @I<100 THEN CONCAT(@C,'00',@I)
					WHEN @I<1000 THEN CONCAT(@C,'0',@I)
					WHEN @I<9999 THEN CONCAT(@C,@I)
					ELSE 'NA'
			END;
	RETURN @ID;
END;

SELECT DBO.IDGEN('B',9999);

CREATE SEQUENCE SUPP1
AS INT
START WITH 6
INCREMENT BY 1
MINVALUE 1
MAXVALUE 9999
NO CYCLE;

DROP PROCEDURE ADDSUPP;

SELECT * FROM SUPPLIER;

CREATE PROCEDURE ADDSUPP @SN VARCHAR(30),@SA VARCHAR(50),@SC VARCHAR(20),@SP VARCHAR(15),@SE VARCHAR(40)
AS
BEGIN
	DECLARE @I AS INT
	DECLARE @ID AS VARCHAR(5)
	SET @I=(NEXT VALUE FOR SUPP1)
	SET @ID= DBO.IDGEN('S',@I)
	INSERT INTO SUPPLIER VALUES(@ID,@SN,@SA,@SC,@SP,@SE)
	SELECT * FROM SUPPLIER
	WHERE SID=@ID
END;

ADDSUPP 'ATUL SHARMA','31/4 PITAMPURA','DELHI','8877995522','AS@GMAIL.COM';

SELECT * FROM PRODUCT;

DROP SEQUENCE CUST1;

CREATE SEQUENCE PRO1
AS INT
START WITH 38
MINVALUE 1
MAXVALUE 9999
NO CYCLE;

DROP PROCEDURE ADDPRO;

CREATE PROCEDURE ADDPRO @PD VARCHAR(20),@PP INT,@PC VARCHAR(20),@PS VARCHAR(5)
AS
BEGIN
	DECLARE @I AS INT
	DECLARE @ID AS CHAR(5)
	SET @I=(NEXT VALUE FOR PRO1)
	SET @ID=DBO.IDGEN('P',@I)
	INSERT INTO PRODUCT VALUES(@ID,@PD,@PP,@PC,@PS)
	SELECT * FROM PRODUCT
	WHERE PID=@ID
END;

SELECT * FROM PRODUCT;

ADDPRO 'HP_MOUSE',1300,'IT','S0003';

DELETE FROM PRODUCT WHERE PID='C0037';

SELECT * FROM CUSTOMER;

DROP SEQUENCE CUS1;

CREATE SEQUENCE CUS1
AS INT
START WITH 8 
INCREMENT BY 1
MINVALUE 1
MAXVALUE 9999
NO CYCLE;

DROP PROCEDURE ADDCUS;

CREATE PROCEDURE ADDCUS @CN VARCHAR(20),@CA VARCHAR(50),@CC VARCHAR(20),@CP VARCHAR(15),@CE VARCHAR(40),@CDOB DATE
AS
BEGIN
	DECLARE @I AS INT
	DECLARE @ID AS CHAR(5)
	SET @I=(NEXT VALUE FOR CUS1)
	SET @ID=DBO.IDGEN('C',@I)
	INSERT INTO CUSTOMER VALUES(@ID,@CN,@CA,@CC,@CP,@CE,@CDOB)
	SELECT * FROM CUSTOMER
	WHERE CID=@ID
END;

CREATE SEQUENCE ORD1
AS INT
START WITH 6
INCREMENT BY 1
MINVALUE 1
MAXVALUE 9999
NO CYCLE;

DROP PROCEDURE ADDORD;

CREATE PROCEDURE ADDORD @OCID VARCHAR(5),@OPID VARCHAR(5),@OQTY INT
AS
BEGIN
	DECLARE @I AS INT
	DECLARE @ID AS CHAR(5)
	SET @I=(NEXT VALUE FOR ORD1)
	SET @ID=DBO.IDGEN('O',@I) 
	INSERT INTO ORDERS(OID,CID,PID,ORDER_QUANTITY) VALUES(@ID,@OCID,@OPID,@OQTY)
	SELECT * FROM ORDERS
	WHERE OID=@ID
END;


SELECT * FROM ORDERS;

DELETE FROM ORDERS WHERE OID='O0008';

ADDORD 'C0002','P0012',20;
  	  
